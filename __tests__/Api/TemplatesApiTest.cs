/*
 * Lob
 *
 * The Lob API is organized around REST. Our API is designed to have predictable, resource-oriented URLs and uses HTTP response codes to indicate any API errors. <p> Looking for our [previous documentation](https://lob.github.io/legacy-docs/)?
 *
 * The version of the OpenAPI document: 1.3.0
 * Contact: lob-openapi@lob.com
 * Generated by: https://github.com/openapitools/openapi-generator.git
 */

using System;
using System.Collections.Generic;
using NUnit.Framework;

using Moq;

using lob.dotnet.Client;
using lob.dotnet.Api;
using lob.dotnet.Model;

namespace __tests__.Api
{
    /// <summary>
    ///  Class for testing TemplatesApi
    /// </summary>
    [TestFixture]
    [Parallelizable(scope: ParallelScope.Self)]
    public class TemplatesApiTests : IDisposable
    {
        private Mock<ITemplatesApi> templatesApiMock;
        private TemplateList fakeTemplateList;
        private Template fakeTemplate;

        public TemplatesApiTests()
        {
            templatesApiMock = new Mock<ITemplatesApi>();

            TemplateVersion fakeTemplateVersion = new TemplateVersion();
            fakeTemplateVersion.setId("vrsn_fakeId");
            fakeTemplateVersion.setDescription(default(string));
            fakeTemplateVersion.setHtml("fake html");
            fakeTemplateVersion.setEngine(default(EngineHtml));
            fakeTemplateVersion.setSuggestJsonEditor(default(bool));
            fakeTemplateVersion.setMergeVariables(default(Object));
            fakeTemplateVersion.setDateCreated(default(DateTime));
            fakeTemplateVersion.setDateModified(default(DateTime));
            fakeTemplateVersion.setDeleted(default(bool));
            fakeTemplateVersion.setObject(TemplateVersion.ObjectEnum.Version);

            fakeTemplate = new Template();
            fakeTemplate.setDescription(default(string));
            fakeTemplate.setId("tmpl_fakeId");
            fakeTemplate.setVersions(new List<TemplateVersion>());
            fakeTemplate.setPublishedVersion(fakeTemplateVersion);
            fakeTemplate.setObject(Template.ObjectEnum.Template);
            fakeTemplate.setMetadata(default(Dictionary<string, string>));
            fakeTemplate.setDateCreated(default(DateTime));
            fakeTemplate.setDateModified(default(DateTime));
            fakeTemplate.setDeleted(default(bool));

            List<Template> listOfTemplates = new List<Template>();
            Template data1 = new Template();
            data1.setDescription(default(string));
            data1.setId("tmpl_fakeId1");
            data1.setVersions(new List<TemplateVersion>());
            data1.setPublishedVersion(fakeTemplateVersion);
            data1.setObject(Template.ObjectEnum.Template);
            data1.setMetadata(default(Dictionary<string, string>));
            data1.setDateCreated(default(DateTime));
            data1.setDateModified(default(DateTime));
            data1.setDeleted(default(bool));
            Template data2 = new Template();
            data2.setDescription(default(string));
            data2.setId("tmpl_fakeId2");
            data2.setVersions(new List<TemplateVersion>());
            data2.setPublishedVersion(fakeTemplateVersion);
            data2.setObject(Template.ObjectEnum.Template);
            data2.setMetadata(default(Dictionary<string, string>));
            data2.setDateCreated(default(DateTime));
            data2.setDateModified(default(DateTime));
            data2.setDeleted(default(bool));

            listOfTemplates.Add(data1);
            listOfTemplates.Add(data2);

            fakeTemplateList = new TemplateList();

            fakeTemplateList.setData(listOfTemplates);
            fakeTemplateList.setObject("list");
            fakeTemplateList.setCount(listOfTemplates.Count);
        }

        public void Dispose()
        {
            // Cleanup when everything is done.
        }

        /// <summary>
        /// Test CreateTemplate
        /// </summary>
        [Test]
        public void CreateTemplateTest()
        {
            TemplateWritable templateWritable = new TemplateWritable();
            templateWritable.setDescription("C# unit test description");
            templateWritable.setHtml("<html>Updated HTML</html>");
            templateWritable.setMetadata(default(Dictionary<string, string>));
            templateWritable.setEngine(default(EngineHtml));

            templatesApiMock.Setup(x => x.CreateTemplate(templateWritable, It.IsAny<int>())).Returns(fakeTemplate);
            Template response = templatesApiMock.Object.CreateTemplate(templateWritable);

            Assert.IsInstanceOf<Template>(response);
            Assert.AreEqual(response.getId(), "tmpl_fakeId");
        }

        /// <summary>
        /// Test CreateTemplateHandlesException
        /// </summary>
        [Test]
        public void CreateTemplateTestHandlesException()
        {
            ApiException fakeException = new ApiException(
                402,
                "This is an error"
            );

            templatesApiMock.Setup(x => x.CreateTemplate(null, It.IsAny<int>())).Throws(fakeException);
            try {
                Template response = templatesApiMock.Object.CreateTemplate(null);
            }
            catch (Exception e) {
                Assert.IsInstanceOf<ApiException>(e);
                Assert.AreEqual(e.Message, fakeException.Message);
            }
        }

        /// <summary>
        /// Test TemplateDelete
        /// </summary>
        [Test]
        public void TemplateDeleteTest()
        {
            TemplateDeletion fakeTemplate = new TemplateDeletion();

            fakeTemplate.setId("tmpl_fakeId");
            fakeTemplate.setDeleted(true);

            templatesApiMock.Setup(x => x.TemplateDelete(fakeTemplate.getId(), It.IsAny<int>())).Returns(fakeTemplate);

            var response = templatesApiMock.Object.TemplateDelete(fakeTemplate.getId());

            Assert.IsInstanceOf<TemplateDeletion>(response);
            Assert.AreEqual(response.getDeleted(), fakeTemplate.getDeleted());
            Assert.AreEqual(response.getId(), fakeTemplate.getId());
        }

        /// <summary>
        /// Test TemplateDeleteHandlesException
        /// </summary>
        [Test]
        public void TemplateDeleteHandlesException()
        {
            ApiException fakeException = new ApiException(
                402,
                "This is an error"
            );

            templatesApiMock.Setup(x => x.TemplateDelete(null, It.IsAny<int>())).Throws(fakeException);
            try {
                var response = templatesApiMock.Object.TemplateDelete(null);
            }
            catch (Exception e) {
                Assert.IsInstanceOf<ApiException>(e);
                Assert.AreEqual(e.Message, fakeException.Message);
            }
        }

        /// <summary>
        /// Test TemplateRetrieve
        /// </summary>
        [Test]
        public void TemplateRetrieveTest()
        {
            templatesApiMock.Setup(x => x.TemplateRetrieve(fakeTemplate.getId(), It.IsAny<int>())).Returns(fakeTemplate);
            Template response = templatesApiMock.Object.TemplateRetrieve(fakeTemplate.getId());

            Assert.IsInstanceOf<Template>(response);
            Assert.AreEqual(response.getId(), fakeTemplate.getId());
        }

        /// <summary>
        /// Test TemplateRetrieveHandlesException
        /// </summary>
        [Test]
        public void TemplateRetrieveTestHandlesException()
        {
            ApiException fakeException = new ApiException(
                402,
                "This is an error"
            );
            templatesApiMock.Setup(x => x.TemplateRetrieve(null, It.IsAny<int>())).Throws(fakeException);

            try {
                var response = templatesApiMock.Object.TemplateRetrieve(null);
            }
            catch (Exception e) {
                Assert.IsInstanceOf<ApiException>(e);
                Assert.AreEqual(e.Message, fakeException.Message);
            }
        }

        /// <summary>
        /// Test TemplateList
        /// </summary>
        [Test]
        public void TemplateListTest()
        {
            templatesApiMock.Setup(x => x.TemplatesList(null, null, null, null, null, null, It.IsAny<int>())).Returns(fakeTemplateList);

            var response = templatesApiMock.Object.TemplatesList(null, null, null, null, null, null);

            Assert.IsInstanceOf<TemplateList>(response);
            Assert.AreEqual(response.getCount(), fakeTemplateList.getCount());
        }

        /// <summary>
        /// Test TemplateListHandlesException
        /// </summary>
        [Test]
        public void TemplateListTestHandlesException()
        {
            ApiException fakeException = new ApiException(
                402,
                "This is an error"
            );
            templatesApiMock.Setup(x => x.TemplatesList(null, null, null, null, null, null, It.IsAny<int>())).Throws(fakeException);

            try {
                var response = templatesApiMock.Object.TemplatesList(null, null, null, null, null, null);
            }
            catch (Exception e) {
                Assert.IsInstanceOf<ApiException>(e);
                Assert.AreEqual(e.Message, fakeException.Message);
            }
        }

        /// <summary>
        /// Test TemplateListWithLimitParam
        /// </summary>
        [Test]
        public void TemplateListTestWithLimitParam()
        {
            int limit = 2;

            templatesApiMock.Setup(x => x.TemplatesList(limit, null, null, null, null, null, It.IsAny<int>())).Returns(fakeTemplateList);

            var response = templatesApiMock.Object.TemplatesList(limit, null, null, null, null, null);

            Assert.IsInstanceOf<TemplateList>(response);
            Assert.AreEqual(response.getCount(), fakeTemplateList.getCount());
        }

        /// <summary>
        /// Test TemplateListWithBeforeParam
        /// </summary>
        [Test]
        public void TemplateListTestWithBeforeParam()
        {
            string before = "before";

            templatesApiMock.Setup(x => x.TemplatesList(null, before, null, null, null, null, It.IsAny<int>())).Returns(fakeTemplateList);

            var response = templatesApiMock.Object.TemplatesList(null, before, null, null, null, null);

            Assert.IsInstanceOf<TemplateList>(response);
            Assert.AreEqual(response.getCount(), fakeTemplateList.getCount());
        }

        /// <summary>
        /// Test TemplateListWithAfterParam
        /// </summary>
        [Test]
        public void TemplateListTestWithAfterParam()
        {
            string after = "after";

            templatesApiMock.Setup(x => x.TemplatesList(null, null, after, null, null, null, It.IsAny<int>())).Returns(fakeTemplateList);

            var response = templatesApiMock.Object.TemplatesList(null, null, after, null, null, null);

            Assert.IsInstanceOf<TemplateList>(response);
            Assert.AreEqual(response.getCount(), fakeTemplateList.getCount());
        }

        /// <summary>
        /// Test TemplateListWithIncludeParam
        /// </summary>
        [Test]
        public void TemplateListTestWithIncludeParam()
        {
            List<string> include = new List<string>();
            include.Add("total_count");

            templatesApiMock.Setup(x => x.TemplatesList(null, null, null, include, null, null, It.IsAny<int>())).Returns(fakeTemplateList);

            var response = templatesApiMock.Object.TemplatesList(null, null, null, include, null, null);

            Assert.IsInstanceOf<TemplateList>(response);
            Assert.AreEqual(response.getCount(), fakeTemplateList.getCount());
        }

        /// <summary>
        /// Test TemplateListWithDateCreatedParam
        /// </summary>
        [Test]
        public void TemplateListTestWithDateCreatedParam()
        {
            Dictionary<String, DateTime> dateCreated = new Dictionary<String, DateTime>();
            DateTime lastMonth = DateTime.Today.AddMonths(-1);
            dateCreated.Add("lt", lastMonth);

            templatesApiMock.Setup(x => x.TemplatesList(null, null, null, null, dateCreated, null, It.IsAny<int>())).Returns(fakeTemplateList);

            var response = templatesApiMock.Object.TemplatesList(null, null, null, null, dateCreated, null);

            Assert.IsInstanceOf<TemplateList>(response);
            Assert.AreEqual(response.getCount(), fakeTemplateList.getCount());
        }

        /// <summary>
        /// Test TemplateListWithMetadataParam
        /// </summary>
        [Test]
        public void TemplateListTestWithMetadataParam()
        {
            Dictionary<String, String> metadata = new Dictionary<String, String>();
            metadata.Add("name", "Harry");

            templatesApiMock.Setup(x => x.TemplatesList(null, null, null, null, null, metadata, It.IsAny<int>())).Returns(fakeTemplateList);

            var response = templatesApiMock.Object.TemplatesList(null, null, null, null, null, metadata);

            Assert.IsInstanceOf<TemplateList>(response);
            Assert.AreEqual(response.getCount(), fakeTemplateList.getCount());
        }

        /// <summary>
        /// Test TemplateUpdate
        /// </summary>
        [Test]
        public void TemplateUpdateTest()
        {
            TemplateUpdate templateUpdate = new TemplateUpdate();
            templateUpdate.setDescription("C# unit test template update description");
            templateUpdate.setPublishedVersion("vrsn_fakeId");

            templatesApiMock.Setup(x => x.TemplateUpdate(fakeTemplate.getId(), templateUpdate, It.IsAny<int>())).Returns(fakeTemplate);

            Template response = templatesApiMock.Object.TemplateUpdate(fakeTemplate.getId(), templateUpdate);

            Assert.IsInstanceOf<Template>(response);
            Assert.AreEqual(response.getId(), fakeTemplate.getId());
        }

        /// <summary>
        /// Test TemplateUpdateHandlesException
        /// </summary>
        [Test]
        public void TemplateUpdateTestHandlesException()
        {
            ApiException fakeException = new ApiException(
                402,
                "This is an error"
            );
            templatesApiMock.Setup(x => x.TemplateUpdate(null, null, It.IsAny<int>())).Throws(fakeException);

            try {
                var response = templatesApiMock.Object.TemplateUpdate(null, null);
            }
            catch (Exception e) {
                Assert.IsInstanceOf<ApiException>(e);
                Assert.AreEqual(e.Message, fakeException.Message);
            }
        }
    }
}