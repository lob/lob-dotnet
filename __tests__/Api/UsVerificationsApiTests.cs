/*
 * Lob
 *
 * The Lob API is organized around REST. Our API is designed to have predictable, resource-oriented URLs and uses HTTP response codes to indicate any API errors. <p> Looking for our [previous documentation](https://lob.github.io/legacy-docs/)?
 *
 * The version of the OpenAPI document: 1.3.0
 * Contact: lob-openapi@lob.com
 * Generated by: https://github.com/openapitools/openapi-generator.git
 */

using System;
using System.Collections.Generic;
using NUnit.Framework;

using Moq;

using lob.dotnet.Client;
using lob.dotnet.Api;
using lob.dotnet.Model;

namespace __tests__.Api
{
    /// <summary>
    ///  Class for testing UsVerificationsApi
    /// </summary>
    [TestFixture]
    [Category("Unit")]
    [Parallelizable(scope: ParallelScope.Self)]
    public class UsVerificationsApiTests : IDisposable
    {
        private Mock<IUsVerificationsApi> usVerificationsApiMock;
        private UsVerificationsWritable usVerificationsWritable;
        private MultipleComponentsList addressList;
        private List<MultipleComponents> addresses;

        public UsVerificationsApiTests()
        {
            usVerificationsApiMock = new Mock<IUsVerificationsApi>();
            usVerificationsWritable = new UsVerificationsWritable(
                null, // address
                null, // recipient
                "370 WATER ST", // primaryLine
                null, // secondaryLine
                null, // urbanization
                null, // city
                null, // state
                "07090" // zipCode
            );

            MultipleComponents address1 = new MultipleComponents(
              null, // recipient
              "370 WATER ST", // primaryLine
              null, // secondaryLine
              null, // urbanization
              null, // city
              null, // state
              "12345" // zipCode
            );

            MultipleComponents address2 = new MultipleComponents(
              null, // recipient
              "012 PLACEHOLDER ST", // primaryLine
              null, // secondaryLine
              null, // urbanization
              null, // city
              null, // state
              "12345" // zipCode
            );

            addresses = new List<MultipleComponents>();
            addresses.Add(address1);
            addresses.Add(address2);

            addressList = new MultipleComponentsList(addresses);
        }

        public void Dispose()
        {
            // Cleanup when everything is done.
        }

        /// <summary>
        /// Test UsVerificationVerifySingle
        /// </summary>
        [Test]
        public void UsVerificationVerifySingleTest()
        {
            UsVerification fakeUsVerification = new UsVerification(
                null, // id
                null, // recipient
                null, // primaryLine
                null, // secondaryLine
                null, // urbanization
                null, // lastLine
                UsVerification.DeliverabilityEnum.Deliverable // deliverability
            );
            fakeUsVerification.Deliverability = UsVerification.DeliverabilityEnum.Deliverable;

            usVerificationsApiMock.Setup(x => x.verifySingle(usVerificationsWritable, null, It.IsAny<int>())).Returns(fakeUsVerification);
            UsVerification response = usVerificationsApiMock.Object.verifySingle(usVerificationsWritable, null);

            Assert.IsInstanceOf<UsVerification>(response);
            Assert.AreEqual(response.Deliverability, fakeUsVerification.Deliverability);
        }

        /// <summary>
        /// Test UsVerificationVerifySingleWithCase
        /// </summary>
        [Test]
        public void UsVerificationVerifySingleTestWithCase()
        {
            UsVerification fakeUsVerification = new UsVerification(
                null, // id
                null, // recipient
                null, // primaryLine
                null, // secondaryLine
                null, // urbanization
                null, // lastLine
                UsVerification.DeliverabilityEnum.Deliverable // deliverability
            );
            fakeUsVerification.Deliverability = UsVerification.DeliverabilityEnum.Deliverable;

            usVerificationsApiMock.Setup(x => x.verifySingle(usVerificationsWritable, "upper", It.IsAny<int>())).Returns(fakeUsVerification);
            UsVerification response = usVerificationsApiMock.Object.verifySingle(usVerificationsWritable, "upper");

            Assert.IsInstanceOf<UsVerification>(response);
            Assert.AreEqual(response.Deliverability, fakeUsVerification.Deliverability);
        }

        /// <summary>
        /// Test UsVerificationVerifySingleHandlesException
        /// </summary>
        [Test]
        public void UsVerificationVerifySingleTestHandlesException()
        {
            ApiException fakeException = new ApiException(
                402,
                "This is an error"
            );

            usVerificationsApiMock.Setup(x => x.verifySingle(null, null, It.IsAny<int>())).Throws(fakeException);
            try {
                UsVerification response = usVerificationsApiMock.Object.verifySingle(null, null);
            }
            catch (Exception e) {
                Assert.IsInstanceOf<ApiException>(e);
                Assert.AreEqual(e.Message, fakeException.Message);
            }
        }

        /// <summary>
        /// Test UsVerificationVerifyBulk
        /// </summary>
        [Test]
        public void UsVerificationVerifyBulkTest()
        {
            List<UsVerificationOrError> fakeAddresses = new List<UsVerificationOrError>();
            UsVerificationOrError fakeAddress = new UsVerificationOrError(
                "us_ver_fakeId", // id
                null, // recipient
                null, // primaryLine
                null, // secondaryLine
                null, // urbanization
                null, // lastLine
                UsVerificationOrError.DeliverabilityEnum.Deliverable // deliverability
            );
            fakeAddresses.Add(fakeAddress);
            fakeAddresses.Add(fakeAddress);

            UsVerifications fakeUsVerifications = new UsVerifications(fakeAddresses, true);

            usVerificationsApiMock.Setup(x => x.verifyBulk(addressList, null, It.IsAny<int>())).Returns(fakeUsVerifications);
            UsVerifications response = usVerificationsApiMock.Object.verifyBulk(addressList, null);

            Assert.IsInstanceOf<UsVerifications>(response);
            Assert.AreEqual(response.Addresses.Count, addresses.Count);
        }

        /// <summary>
        /// Test UsVerificationVerifyBulkWithCase
        /// </summary>
        [Test]
        public void UsVerificationVerifyBulkTestWithCase()
        {
            List<UsVerificationOrError> fakeAddresses = new List<UsVerificationOrError>();
            UsVerificationOrError fakeAddress = new UsVerificationOrError(
                "us_ver_fakeId", // id
                null, // recipient
                null, // primaryLine
                null, // secondaryLine
                null, // urbanization
                null, // lastLine
                UsVerificationOrError.DeliverabilityEnum.Deliverable // deliverability
            );
            fakeAddresses.Add(fakeAddress);
            fakeAddresses.Add(fakeAddress);

            UsVerifications fakeUsVerifications = new UsVerifications(fakeAddresses, true);

            usVerificationsApiMock.Setup(x => x.verifyBulk(addressList, "upper", It.IsAny<int>())).Returns(fakeUsVerifications);
            UsVerifications response = usVerificationsApiMock.Object.verifyBulk(addressList, "upper");

            Assert.IsInstanceOf<UsVerifications>(response);
            Assert.AreEqual(response.Addresses.Count, addresses.Count);
        }

        /// <summary>
        /// Test UsVerificationVerifyBulkHandlesException
        /// </summary>
        [Test]
        public void UsVerificationVerifyBulkTestHandlesException()
        {
            ApiException fakeException = new ApiException(
                402,
                "This is an error"
            );

            usVerificationsApiMock.Setup(x => x.verifyBulk(null, null, It.IsAny<int>())).Throws(fakeException);
            try {
                UsVerifications response = usVerificationsApiMock.Object.verifyBulk(null, null);
            }
            catch (Exception e) {
                Assert.IsInstanceOf<ApiException>(e);
                Assert.AreEqual(e.Message, fakeException.Message);
            }
        }
    }
}
