/*
 * Lob
 *
 * The Lob API is organized around REST. Our API is designed to have predictable, resource-oriented URLs and uses HTTP response codes to indicate any API errors. <p> Looking for our [previous documentation](https://lob.github.io/legacy-docs/)?
 *
 * The version of the OpenAPI document: 1.3.0
 * Contact: lob-openapi@lob.com
 * Generated by: https://github.com/openapitools/openapi-generator.git
 */

using System;
using System.Collections.Generic;
using NUnit.Framework;

using Moq;

using lob.dotnet.Client;
using lob.dotnet.Api;
using lob.dotnet.Model;

namespace __tests__.Api
{
    /// <summary>
    ///  Class for testing CardOrdersApi
    /// </summary>
    [TestFixture]
    [Parallelizable(scope: ParallelScope.Self)]
    public class CardOrdersApiTests : IDisposable
    {
        private Mock<ICardOrdersApi> cardOrdersApiMock;
        private CardOrder fakeCardOrder;
        private Card fakeCard;

        public CardOrdersApiTests()
        {
            cardOrdersApiMock = new Mock<ICardOrdersApi>();
            string fakeCardId = "card_fakeId";
            fakeCardOrder = new CardOrder();
            fakeCardOrder.setId("co_fakeId");
            fakeCardOrder.setCardId(fakeCardId);
            fakeCardOrder.setInventory(0M);
            fakeCardOrder.setQuantityOrdered(0M);
            fakeCardOrder.setUnitPrice(0M);
            fakeCardOrder.setCancelledReason(default(string));
            fakeCardOrder.setAvailabilityDate(default(DateTime));
            fakeCardOrder.setExpectedAvailabilityDate(default(DateTime));
            fakeCardOrder.setDateCreated(default(DateTime));
            fakeCardOrder.setDateModified(default(DateTime));
            fakeCardOrder.setDeleted(default(bool));
            fakeCardOrder.setObject("card_order");

            fakeCard = new Card();
            fakeCard.setId(fakeCardId);
            fakeCard.setUrl("fake url");
            fakeCard.setAutoReorder(false);
            fakeCard.setRawUrl("fake raw url");
            fakeCard.setFrontOriginalUrl("fake front original url");
            fakeCard.setBackOriginalUrl("fake back original url");
            fakeCard.setThumbnails(new List<Thumbnail>());
            fakeCard.setAvailableQuantity(0);
            fakeCard.setPendingQuantity(0);
            fakeCard.setStatus(default(Card.StatusEnum));
            fakeCard.setOrientation(Card.OrientationEnum.Horizontal);
            fakeCard.setThresholdAmount(0);
            fakeCard.setDateCreated(default(DateTime));
            fakeCard.setDateModified(default(DateTime));
            fakeCard.setDeleted(default(bool));
            fakeCard.setObject(Card.ObjectEnum.Card);
            fakeCard.setDescription(default(string));
            fakeCard.setSize(Card.SizeEnum._2125x3375);
        }

        public void Dispose()
        {
            // Cleanup when everything is done.
        }

        /// <summary>
        /// Test CardOrderCreate
        /// </summary>
        [Test]
        public void CardOrderCreateTest()
        {
            CardOrderEditable cardOrderEditable = new CardOrderEditable();
            cardOrderEditable.setQuantity(10000);

            cardOrdersApiMock.Setup(x => x.CardOrderCreate("card_fakeId", cardOrderEditable, It.IsAny<int>())).Returns(fakeCardOrder);
            CardOrder response = cardOrdersApiMock.Object.CardOrderCreate("card_fakeId", cardOrderEditable);

            Assert.IsInstanceOf<CardOrder>(response);
            Assert.AreEqual(response.getId(), fakeCardOrder.getId());
        }

        /// <summary>
        /// Test CardOrderCreateHandlesException
        /// </summary>
        [Test]
        public void CardOrderCreateTestHandlesException()
        {
            ApiException fakeException = new ApiException(
                402,
                "This is an error"
            );

            cardOrdersApiMock.Setup(x => x.CardOrderCreate(null, null, It.IsAny<int>())).Throws(fakeException);
            try {
                CardOrder response = cardOrdersApiMock.Object.CardOrderCreate(null, null);
            }
            catch (Exception e) {
                Assert.IsInstanceOf<ApiException>(e);
                Assert.AreEqual(e.Message, fakeException.Message);
            }
        }

        /// <summary>
        /// Test CardOrdersRetrieve
        /// </summary>
        [Test]
        public void CardOrdersRetrieveTest()
        {
            CardOrderList fakeCardOrderList = new CardOrderList();
            List<CardOrder> cardOrders = new List<CardOrder>();
            cardOrders.Add(fakeCardOrder);
            fakeCardOrderList.setData(cardOrders);

            cardOrdersApiMock.Setup(x => x.CardOrdersRetrieve(fakeCard.getId(), null, null, It.IsAny<int>())).Returns(fakeCardOrderList);
            CardOrderList response = cardOrdersApiMock.Object.CardOrdersRetrieve(fakeCard.getId());

            Assert.IsInstanceOf<CardOrderList>(response);

            Boolean retrievedCardOrder = false;
            foreach(var cardOrder in response.getData()) {
                if (cardOrder.getCardId() == fakeCard.getId())
                    retrievedCardOrder = true;
            }
            Assert.True(retrievedCardOrder);
        }

        /// <summary>
        /// Test CardOrdersRetrieveHandlesException
        /// </summary>
        [Test]
        public void CardOrdersRetrieveTestHandlesException()
        {
            ApiException fakeException = new ApiException(
                402,
                "This is an error"
            );
            cardOrdersApiMock.Setup(x => x.CardOrdersRetrieve("fakeId", null, null, It.IsAny<int>())).Throws(fakeException);

            try {
                var response = cardOrdersApiMock.Object.CardOrdersRetrieve("fakeId");
            }
            catch (Exception e) {
                Assert.IsInstanceOf<ApiException>(e);
                Assert.AreEqual(e.Message, fakeException.Message);
            }
        }
    }
}
