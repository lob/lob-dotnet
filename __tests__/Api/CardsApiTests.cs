/*
 * Lob
 *
 * The Lob API is organized around REST. Our API is designed to have predictable, resource-oriented URLs and uses HTTP response codes to indicate any API errors. <p> Looking for our [previous documentation](https://lob.github.io/legacy-docs/)?
 *
 * The version of the OpenAPI document: 1.3.0
 * Contact: lob-openapi@lob.com
 * Generated by: https://github.com/openapitools/openapi-generator.git
 */

using System;
using System.Collections.Generic;
using NUnit.Framework;

using Moq;

using lob.dotnet.Client;
using lob.dotnet.Api;
using lob.dotnet.Model;

namespace __tests__.Api
{
    /// <summary>
    ///  Class for testing CardsApi
    /// </summary>
    [TestFixture]
    [Parallelizable(scope: ParallelScope.Self)]
    public class CardsApiTests : IDisposable
    {
        private Mock<ICardsApi> cardsApiMock;
        private CardList fakeCardList;

        public CardsApiTests()
        {
            cardsApiMock = new Mock<ICardsApi>();

            List<Card> listOfCards = new List<Card>();
            Card data1 = new Card();
            Card data2 = new Card();

            data1.Id = "card_fakeId1";
            data2.Id = "card_fakeId2";
            listOfCards.Add(data1);
            listOfCards.Add(data2);

            fakeCardList = new CardList();

            fakeCardList.Data = listOfCards;
            fakeCardList.Object = "list";
            fakeCardList.Count = listOfCards.Count;
        }

        public void Dispose()
        {
            // Cleanup when everything is done.
        }

        /// <summary>
        /// Test CardCreate
        /// </summary>
        [Test]
        public void CardCreateTest()
        {
            Card fakeCard = new Card();
            fakeCard.Id = "card_fakeId";

            CardEditable cardEditable = new CardEditable(
                "fake front", // front
                "fake back", // back
                CardEditable.SizeEnum._2125x3375, // size
                "fake description" // description
            );

            cardsApiMock.Setup(x => x.CardCreate(cardEditable, It.IsAny<int>())).Returns(fakeCard);
            Card response = cardsApiMock.Object.CardCreate(cardEditable);

            Assert.IsInstanceOf<Card>(response);
            Assert.AreEqual(response.Id, "card_fakeId");
        }

        /// <summary>
        /// Test CardCreateHandlesException
        /// </summary>
        [Test]
        public void CardCreateTestHandlesException()
        {
            Card fakeCard = new Card();
            ApiException fakeException = new ApiException(
                402,
                "This is an error"
            );

            cardsApiMock.Setup(x => x.CardCreate(null, It.IsAny<int>())).Throws(fakeException);
            try {
                Card response = cardsApiMock.Object.CardCreate(null);
            }
            catch (Exception e) {
                Assert.IsInstanceOf<ApiException>(e);
                Assert.AreEqual(e.Message, fakeException.Message);
            }
        }

        /// <summary>
        /// Test CardDelete
        /// </summary>
        [Test]
        public void CardDeleteTest()
        {
            CardDeletion fakeCard = new CardDeletion();

            fakeCard.Id = "card_fakeId";
            fakeCard.Deleted = true;

            cardsApiMock.Setup(x => x.CardDelete(fakeCard.Id, It.IsAny<int>())).Returns(fakeCard);

            var response = cardsApiMock.Object.CardDelete(fakeCard.Id);

            Assert.IsInstanceOf<CardDeletion>(response);
            Assert.AreEqual(response.Deleted, fakeCard.Deleted);
            Assert.AreEqual(response.Id, fakeCard.Id);
        }

        /// <summary>
        /// Test CardDeleteHandlesException
        /// </summary>
        [Test]
        public void CardDeleteHandlesException()
        {
            ApiException fakeException = new ApiException(
                402,
                "This is an error"
            );

            cardsApiMock.Setup(x => x.CardDelete(null, It.IsAny<int>())).Throws(fakeException);
            try {
                var response = cardsApiMock.Object.CardDelete(null);
            }
            catch (Exception e) {
                Assert.IsInstanceOf<ApiException>(e);
                Assert.AreEqual(e.Message, fakeException.Message);
            }
        }

        /// <summary>
        /// Test CardRetrieve
        /// </summary>
        [Test]
        public void CardRetrieveTest()
        {
            Card fakeCard = new Card();

            fakeCard.Id = "card_fakeId";
            cardsApiMock.Setup(x => x.CardRetrieve(fakeCard.Id, It.IsAny<int>())).Returns(fakeCard);
            Card response = cardsApiMock.Object.CardRetrieve(fakeCard.Id);

            Assert.IsInstanceOf<Card>(response);
            Assert.AreEqual(response.Id, fakeCard.Id);
        }

        /// <summary>
        /// Test CardRetrieveHandlesException
        /// </summary>
        [Test]
        public void CardRetrieveTestHandlesException()
        {
            ApiException fakeException = new ApiException(
                402,
                "This is an error"
            );
            cardsApiMock.Setup(x => x.CardRetrieve(null, It.IsAny<int>())).Throws(fakeException);

            try {
                var response = cardsApiMock.Object.CardRetrieve(null);
            }
            catch (Exception e) {
                Assert.IsInstanceOf<ApiException>(e);
                Assert.AreEqual(e.Message, fakeException.Message);
            }
        }

        /// <summary>
        /// Test CardList
        /// </summary>
        [Test]
        public void CardListTest()
        {
            cardsApiMock.Setup(x => x.CardsList(null, null, null, null, It.IsAny<int>())).Returns(fakeCardList);

            var response = cardsApiMock.Object.CardsList(null, null, null, null);

            Assert.IsInstanceOf<CardList>(response);
            Assert.AreEqual(response.Count, fakeCardList.Count);
        }

        /// <summary>
        /// Test CardListHandlesException
        /// </summary>
        [Test]
        public void CardListTestHandlesException()
        {
            ApiException fakeException = new ApiException(
                402,
                "This is an error"
            );
            cardsApiMock.Setup(x => x.CardsList(null, null, null, null, It.IsAny<int>())).Throws(fakeException);

            try {
                var response = cardsApiMock.Object.CardsList(null, null, null, null);
            }
            catch (Exception e) {
                Assert.IsInstanceOf<ApiException>(e);
                Assert.AreEqual(e.Message, fakeException.Message);
            }
        }

        /// <summary>
        /// Test CardListWithLimitParam
        /// </summary>
        [Test]
        public void CardListTestWithLimitParam()
        {
            int limit = 2;

            cardsApiMock.Setup(x => x.CardsList(limit, null, null, null, It.IsAny<int>())).Returns(fakeCardList);

            var response = cardsApiMock.Object.CardsList(limit, null, null, null);

            Assert.IsInstanceOf<CardList>(response);
            Assert.AreEqual(response.Count, fakeCardList.Count);
        }

        /// <summary>
        /// Test CardListWithBeforeParam
        /// </summary>
        [Test]
        public void CardListTestWithBeforeParam()
        {
            string before = "before";

            cardsApiMock.Setup(x => x.CardsList(null, before, null, null, It.IsAny<int>())).Returns(fakeCardList);

            var response = cardsApiMock.Object.CardsList(null, before, null, null);

            Assert.IsInstanceOf<CardList>(response);
            Assert.AreEqual(response.Count, fakeCardList.Count);
        }

        /// <summary>
        /// Test CardListWithAfterParam
        /// </summary>
        [Test]
        public void CardListTestWithAfterParam()
        {
            string after = "after";

            cardsApiMock.Setup(x => x.CardsList(null, null, after, null, It.IsAny<int>())).Returns(fakeCardList);

            var response = cardsApiMock.Object.CardsList(null, null, after, null);

            Assert.IsInstanceOf<CardList>(response);
            Assert.AreEqual(response.Count, fakeCardList.Count);
        }

        /// <summary>
        /// Test CardListWithSortByParam
        /// </summary>
        [Test]
        public void CardListTestWithSortByParam()
        {
            SortBy5 sortBy = new SortBy5(null, SortBy5.SendDateEnum.Desc);

            cardsApiMock.Setup(x => x.CardsList(null, null, null, sortBy, It.IsAny<int>())).Returns(fakeCardList);

            var response = cardsApiMock.Object.CardsList(null, null, null, sortBy);

            Assert.IsInstanceOf<CardList>(response);
            Assert.AreEqual(response.Count, fakeCardList.Count);
        }

        /// <summary>
        /// Test CardUpdate
        /// </summary>
        [Test]
        public void CardUpdateTest()
        {
            CardUpdatable cardUpdatable = new CardUpdatable(
                "Awesome card",
                true,
                10000
            );

            Card fakeCard = new Card();
            fakeCard.Id = "card_fakeId";

            cardsApiMock.Setup(x => x.CardUpdate(fakeCard.Id, cardUpdatable, It.IsAny<int>())).Returns(fakeCard);

            Card response = cardsApiMock.Object.CardUpdate(fakeCard.Id, cardUpdatable);

            Assert.IsInstanceOf<Card>(response);
            Assert.AreEqual(response.Id, fakeCard.Id);
            Assert.AreEqual(response.Description, fakeCard.Description);
        }

        /// <summary>
        /// Test CardUpdateHandlesException
        /// </summary>
        [Test]
        public void CardUpdateTestHandlesException()
        {
            ApiException fakeException = new ApiException(
                402,
                "This is an error"
            );
            cardsApiMock.Setup(x => x.CardUpdate(null, null, It.IsAny<int>())).Throws(fakeException);

            try {
                var response = cardsApiMock.Object.CardUpdate(null, null);
            }
            catch (Exception e) {
                Assert.IsInstanceOf<ApiException>(e);
                Assert.AreEqual(e.Message, fakeException.Message);
            }
        }
    }
}
